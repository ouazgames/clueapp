<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
  <link rel="apple-touch-icon" sizes="120x120" href="/images/favicon-120x120.png" />
  <link rel="apple-touch-icon" sizes="152x152" href="/images/favicon-152x152.png" />
  <link rel="apple-touch-icon" sizes="167x167" href="/images/favicon-167x167.png" />
  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon-180x180.png" />

  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png" />
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png" />
  <link rel="icon" type="image/png" sizes="48x48" href="/images/favicon-48x48.png" />
  <link rel="icon" type="image/png" sizes="64x64" href="/images/favicon-64x64.png" />
  <link rel="shortcut icon" href="/images/favicon.ico" />
  <link rel="stylesheet" href="common.css" />

  <meta property="og:title" content="Clues by Sam" />
  <meta property="og:image" content="https://cluesbysam.com/images/74029611514d.jpg" />
  <meta property="og:description" content="A logic puzzle where you deduce who is a criminal!" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:image" content="https://cluesbysam.com/images/74029611514d.jpg" />
  <meta name="color-scheme" content="light only" />
  <meta name="supported-color-schemes" content="light" />
  <meta name="robots" content="max-image-preview:large" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Ribeye&display=swap" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Comic+Neue:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&display=swap"
    rel="stylesheet" />
  <title>Clues By Sam</title>
  <style>
    :root {
      --safe-area-inset-top: env(safe-area-inset-top);
      --safe-area-inset-bottom: env(safe-area-inset-bottom);
      --safe-area-inset-left: env(safe-area-inset-left);
      --safe-area-inset-right: env(safe-area-inset-right);
      --bg-light-blue: #D4EFFF;
      --bg-pink: #FFE4EC;
      --card-blue: #5DADE2;
      --card-pink: #F8A5C2;
      --card-red: #E74C3C;
      --card-green-glow: #2ECC71;
      --header-blue: #3498DB;
      --progress-gold: #F1C40F;
      --progress-bg: #2C3E50;
    }
    
    * {
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    
    html, body {
      height: 100%;
      overflow-x: hidden;
      overscroll-behavior: none;
      margin: 0;
      padding: 0;
    }
    
    body {
      background: linear-gradient(180deg, #A8E6CF 0%, #D4EFFF 30%, #D4EFFF 100%);
      padding-top: env(safe-area-inset-top);
      padding-bottom: calc(env(safe-area-inset-bottom) + 100px);
      padding-left: env(safe-area-inset-left);
      padding-right: env(safe-area-inset-right);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      min-height: -webkit-fill-available;
      font-family: 'Nunito', sans-serif;
    }
    
    /* ==========================================
       SPLASH SCREEN
       ========================================== */
    #splash-screen {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: linear-gradient(180deg, #87CEEB 0%, #9B59B6 100%);
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      z-index: 9999;
      transition: opacity 0.5s ease-out;
    }
    
    #splash-screen.hidden {
      opacity: 0;
      pointer-events: none;
    }
    
    .splash-logo {
      font-family: 'Ribeye', cursive;
      font-size: 48px;
      color: #fff;
      text-shadow: 3px 3px 0 #8E44AD, 5px 5px 10px rgba(0,0,0,0.3);
      text-align: center;
      margin-bottom: 20px;
    }
    
    .splash-icon {
      font-size: 80px;
      margin-bottom: 30px;
    }
    
    .splash-text {
      font-family: 'Nunito', sans-serif;
      font-size: 18px;
      color: #fff;
      margin-bottom: 20px;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.3);
    }
    
    .splash-progress {
      width: 200px;
      height: 20px;
      background: #2C3E50;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: inset 0 2px 5px rgba(0,0,0,0.3);
    }
    
    .splash-progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, #27AE60 0%, #2ECC71 100%);
      border-radius: 10px;
      transition: width 0.3s ease;
    }
    
    /* ==========================================
       HEADER WITH LEVEL AND PROGRESS - REFERENCE STYLE
       ========================================== */
    .game-header {
      background: linear-gradient(180deg, #7B2D8E 0%, #5B1D6E 100%);
      padding: 12px 15px 15px;
      border-radius: 0 0 20px 20px;
      box-shadow: 0 4px 15px rgba(91, 29, 110, 0.4);
      position: relative;
    }
    
    .header-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 10px;
    }
    
    .settings-btn {
      width: 40px;
      height: 40px;
      background: rgba(0,0,0,0.3);
      border: none;
      border-radius: 50%;
      font-size: 22px;
      color: #aaa;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .level-title {
      font-family: 'Nunito', sans-serif;
      font-weight: 900;
      font-size: 28px;
      color: #fff;
      margin: 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .coins-display {
      display: flex;
      align-items: center;
      gap: 6px;
      background: linear-gradient(180deg, #F4D03F 0%, #F39C12 100%);
      padding: 6px 12px;
      border-radius: 20px;
      box-shadow: 0 3px 10px rgba(243, 156, 18, 0.4);
      cursor: pointer;
      transition: transform 0.2s ease;
      position: relative;
    }
    
    .coins-display:active {
      transform: scale(0.95);
    }
    
    .coins-plus {
      position: absolute;
      right: -8px;
      bottom: -4px;
      width: 22px;
      height: 22px;
      background: linear-gradient(180deg, #27AE60 0%, #1E8449 100%);
      border-radius: 50%;
      font-size: 14px;
      font-weight: bold;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }
    
    .coins-icon {
      font-size: 20px;
    }
    
    .coins-amount {
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 16px;
      color: #2C3E50;
    }
    
    .header-bottom {
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 0 15px;
    }
    
    .progress-container {
      position: relative;
      width: 100%;
      max-width: 280px;
      height: 36px;
      background: #4a4a6a;
      border-radius: 18px;
      overflow: hidden;
      box-shadow: inset 0 2px 4px rgba(0,0,0,0.3);
    }
    
    .progress-fill {
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      background: linear-gradient(180deg, #4CAF50 0%, #388E3C 100%);
      border-radius: 18px 0 0 18px;
      transition: width 0.3s ease;
    }
    
    .progress-text {
      position: absolute;
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 18px;
      color: #fff;
      text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
      z-index: 1;
    }
    
    /* Responsive adjustments for smaller screens */
    @media (max-width: 380px) {
      .progress-container {
        max-width: 240px;
        height: 32px;
      }
      .progress-text {
        font-size: 16px;
      }
    }
    
    /* ==========================================
       SHOP POPUP
       ========================================== */
    #shop-popup {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 60000;
    }
    
    #shop-popup.show {
      display: flex;
    }
    
    .shop-content {
      background: linear-gradient(180deg, #3498DB 0%, #2980B9 100%);
      border-radius: 25px;
      padding: 25px 20px;
      max-width: 340px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 10px 40px rgba(0,0,0,0.4);
      border: 4px solid rgba(255,255,255,0.3);
      position: relative;
    }
    
    .shop-close {
      position: absolute;
      top: 15px;
      left: 15px;
      width: 40px;
      height: 40px;
      background: #E74C3C;
      border: none;
      border-radius: 50%;
      font-size: 20px;
      color: #fff;
      cursor: pointer;
      box-shadow: 0 3px 10px rgba(231, 76, 60, 0.4);
      display: flex;
      justify-content: center;
      align-items: center;
    }
    
    .shop-header {
      text-align: center;
      margin-bottom: 20px;
    }
    
    .shop-coins-display {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      background: linear-gradient(180deg, #F4D03F 0%, #F39C12 100%);
      padding: 8px 16px;
      border-radius: 20px;
      margin-bottom: 10px;
    }
    
    .shop-coins-display .coins-amount {
      font-size: 18px;
    }
    
    .shop-title {
      font-family: 'Nunito', sans-serif;
      font-weight: 900;
      font-size: 28px;
      color: #fff;
      margin: 10px 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .shop-items {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .shop-item {
      background: linear-gradient(180deg, #FCF3CF 0%, #F9E79F 100%);
      border-radius: 15px;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: 0 3px 10px rgba(0,0,0,0.15);
      border: 2px solid rgba(255,255,255,0.5);
    }
    
    .shop-item-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .shop-item-icon {
      font-size: 28px;
    }
    
    .shop-item-amount {
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 22px;
      color: #2C3E50;
    }
    
    .shop-item-btn {
      padding: 10px 20px;
      border-radius: 20px;
      border: none;
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 14px;
      cursor: pointer;
      transition: transform 0.2s ease;
    }
    
    .shop-item-btn:active {
      transform: scale(0.95);
    }
    
    .shop-item-btn.free {
      background: linear-gradient(180deg, #F4D03F 0%, #D4AC0D 100%);
      color: #2C3E50;
    }
    
    .shop-item-btn.buy {
      background: linear-gradient(180deg, #27AE60 0%, #1E8449 100%);
      color: #fff;
    }
    
    /* ==========================================
       NOT ENOUGH COINS POPUP
       ========================================== */
    #coins-popup {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 65000;
    }
    
    #coins-popup.show {
      display: flex;
    }
    
    .coins-popup-content {
      background: linear-gradient(180deg, #E74C3C 0%, #C0392B 100%);
      border-radius: 25px;
      padding: 30px;
      text-align: center;
      max-width: 300px;
      width: 90%;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      border: 4px solid rgba(255,255,255,0.3);
    }
    
    .coins-popup-icon {
      font-size: 50px;
      margin-bottom: 15px;
    }
    
    .coins-popup-title {
      font-family: 'Nunito', sans-serif;
      font-weight: 900;
      font-size: 22px;
      color: #fff;
      margin-bottom: 10px;
    }
    
    .coins-popup-message {
      font-family: 'Nunito', sans-serif;
      font-size: 14px;
      color: rgba(255,255,255,0.9);
      margin-bottom: 20px;
    }
    
    .coins-popup-buttons {
      display: flex;
      gap: 10px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .coins-popup-btn {
      padding: 12px 24px;
      border-radius: 20px;
      border: none;
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 14px;
      cursor: pointer;
    }
    
    .coins-popup-btn.watch {
      background: linear-gradient(180deg, #F4D03F 0%, #D4AC0D 100%);
      color: #2C3E50;
    }
    
    .coins-popup-btn.shop {
      background: linear-gradient(180deg, #27AE60 0%, #1E8449 100%);
      color: #fff;
    }
    
    .coins-popup-btn.close {
      background: rgba(255,255,255,0.2);
      color: #fff;
    }
    
    /* ==========================================
       BANNER AD SPACE
       ========================================== */
    .banner-ad-space {
      position: fixed;
      bottom: 0;
      left: 0;
      right: 0;
      height: 50px;
      background: rgba(0,0,0,0.1);
      z-index: 100;
    }
    
    .progress-bar-wrapper {
      width: 180px;
      height: 28px;
      background: linear-gradient(180deg, #34495E 0%, #2C3E50 100%);
      border-radius: 14px;
      padding: 4px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.3), inset 0 2px 3px rgba(0,0,0,0.2);
    }
    
    .progress-bar-fill {
      height: 100%;
      background: linear-gradient(180deg, #F4D03F 0%, #F39C12 100%);
      border-radius: 10px;
      width: 0%;
      transition: width 0.3s ease;
      box-shadow: 0 0 10px rgba(243, 156, 18, 0.5);
    }
    
    .progress-text {
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 20px;
      color: #fff;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
      position: absolute;
      width: 180px;
      text-align: center;
      line-height: 28px;
    }
    
    .progress-bar-inner {
      position: relative;
    }
    
    /* ==========================================
       GAME CONTAINER
       ========================================== */
    #root {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 10px 5px;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }
    
    /* ==========================================
       CARD STYLING OVERRIDES
       ========================================== */
    .card-grid {
      background-color: transparent !important;
    }
    
    .card {
      border-radius: 16px !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15), 0 2px 4px rgba(0,0,0,0.1) !important;
      border: 3px solid rgba(255,255,255,0.6) !important;
      overflow: visible !important;
      transition: all 0.2s ease !important;
    }
    
    .card-container {
      position: relative;
    }
    
    /* ==========================================
       ACTION BUTTONS STYLING
       ========================================== */
    .bottom {
      display: flex;
      justify-content: center;
      gap: 10px;
      flex-wrap: wrap;
      margin-bottom: 20px;
      padding: 0 10px;
    }
    
    .bottom button,
    .bottom input {
      background: linear-gradient(180deg, #2C3E50 0%, #1a252f 100%);
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-family: 'Nunito', sans-serif;
      font-weight: 700;
      font-size: 14px;
      cursor: pointer;
      box-shadow: 0 4px 12px rgba(0,0,0,0.2);
      transition: all 0.2s ease;
      touch-action: manipulation;
    }
    
    .bottom button:active,
    .bottom input:active {
      transform: scale(0.95);
    }
    
    .bottom button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    /* ==========================================
       WIN POPUP - MATCHES REFERENCE SCREENSHOT
       ========================================== */
    #win-popup {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.6);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 50000;
      padding: env(safe-area-inset-top) env(safe-area-inset-right) env(safe-area-inset-bottom) env(safe-area-inset-left);
    }
    
    #win-popup.show {
      display: flex;
    }
    
    .win-content {
      background: #f5f5f5;
      border-radius: 20px;
      padding: 25px 30px;
      text-align: center;
      max-width: 300px;
      width: 85%;
      box-shadow: 0 10px 40px rgba(0,0,0,0.4);
    }
    
    .win-level-title {
      font-family: 'Nunito', sans-serif;
      font-weight: 900;
      font-size: 22px;
      color: #2c3e50;
      margin: 0 0 5px 0;
    }
    
    .win-difficulty {
      font-family: 'Nunito', sans-serif;
      font-weight: 600;
      font-size: 16px;
      color: #7f8c8d;
      margin: 0 0 20px 0;
    }
    
    .win-grid {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      margin-bottom: 20px;
    }
    
    .win-grid-row {
      display: flex;
      gap: 4px;
    }
    
    .win-grid-cell {
      width: 24px;
      height: 24px;
      border-radius: 6px;
    }
    
    .win-grid-cell.green { background: #27AE60; }
    .win-grid-cell.yellow { background: #F1C40F; }
    .win-grid-cell.orange { background: #E67E22; }
    
    .win-message {
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 16px;
      color: #2c3e50;
      margin: 0 0 25px 0;
    }
    
    .win-buttons {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    
    .win-button-next {
      background: linear-gradient(180deg, #27AE60 0%, #1E8449 100%);
      color: #fff;
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 18px;
      padding: 14px 30px;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(39, 174, 96, 0.4);
      transition: transform 0.2s ease;
    }
    
    .win-button-next:active {
      transform: scale(0.95);
    }
    
    .win-button-secondary {
      background: transparent;
      color: #2c3e50;
      font-family: 'Nunito', sans-serif;
      font-weight: 700;
      font-size: 15px;
      padding: 12px 25px;
      border: 2px solid #2c3e50;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .win-button-secondary:active {
      transform: scale(0.95);
      background: rgba(0,0,0,0.05);
    }
    
    .win-button-close {
      background: transparent;
      color: #7f8c8d;
      font-family: 'Nunito', sans-serif;
      font-weight: 600;
      font-size: 14px;
      padding: 10px 20px;
      border: 1px solid #bdc3c7;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .win-button-close:active {
      background: rgba(0,0,0,0.05);
    }
    
    /* ==========================================
       LOSE POPUP
       ========================================== */
    #lose-popup {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.7);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 50000;
    }
    
    #lose-popup.show {
      display: flex;
    }
    
    .lose-content {
      background: linear-gradient(180deg, #E74C3C 0%, #C0392B 100%);
      border-radius: 30px;
      padding: 30px 40px;
      text-align: center;
      max-width: 320px;
      width: 90%;
      box-shadow: 0 10px 40px rgba(0,0,0,0.3);
      border: 4px solid rgba(255,255,255,0.3);
    }
    
    .lose-title {
      font-family: 'Nunito', sans-serif;
      font-weight: 900;
      font-size: 28px;
      color: #fff;
      margin: 0 0 20px 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .lose-button {
      background: linear-gradient(180deg, #95A5A6 0%, #7F8C8D 100%);
      color: #fff;
      font-family: 'Nunito', sans-serif;
      font-weight: 800;
      font-size: 20px;
      padding: 15px 40px;
      border: none;
      border-radius: 25px;
      cursor: pointer;
      box-shadow: 0 4px 15px rgba(0,0,0,0.2);
      transition: transform 0.2s ease;
    }
    
    .lose-button:active {
      transform: scale(0.95);
    }
    
    /* ==========================================
       BANNER MESSAGES
       ========================================== */
    .game-banner {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: linear-gradient(180deg, #3498DB 0%, #2980B9 100%);
      color: #fff;
      font-family: 'Nunito', sans-serif;
      font-weight: 900;
      font-size: 24px;
      padding: 20px 40px;
      border-radius: 15px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.3);
      z-index: 5000;
      display: none;
      text-align: center;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }
    
    .game-banner.show {
      display: block;
      animation: bannerPop 0.3s ease;
    }
    
    @keyframes bannerPop {
      0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
    }
    
    /* ==========================================
       NAVIGATION (HIDDEN)
       ========================================== */
    .nav-container {
      display: none;
    }
    
    /* ==========================================
       RESPONSIVE ADJUSTMENTS
       ========================================== */
    @media (max-width: 380px) {
      .level-title {
        font-size: 26px;
      }
      
      .progress-bar-wrapper {
        width: 150px;
        height: 24px;
      }
      
      .progress-text {
        font-size: 16px;
        width: 150px;
        line-height: 24px;
      }
      
    }
    
    @media (min-width: 768px) {
      .level-title {
        font-size: 40px;
      }
      
      .progress-bar-wrapper {
        width: 250px;
        height: 35px;
      }
      
      .progress-text {
        font-size: 24px;
        width: 250px;
        line-height: 35px;
      }
    }
    
    /* Hide old level display */
    #level-display {
      display: none !important;
    }
    
    /* ==========================================
       RTL SUPPORT (ARABIC)
       ========================================== */
    [dir="rtl"] .header-top {
      flex-direction: row-reverse;
    }
    
    [dir="rtl"] .coins-display {
      flex-direction: row-reverse;
    }
    
    [dir="rtl"] .coins-plus {
      right: auto;
      left: -8px;
    }
    
    [dir="rtl"] .shop-close {
      left: auto;
      right: 15px;
    }
    
    [dir="rtl"] .shop-item {
      flex-direction: row-reverse;
    }
    
    [dir="rtl"] .shop-item-left {
      flex-direction: row-reverse;
    }
    
    [dir="rtl"] .coins-popup-buttons {
      flex-direction: row-reverse;
    }
    
    [dir="rtl"] .win-buttons {
      direction: rtl;
    }
    
    /* ==========================================
       LANGUAGE SELECTOR POPUP
       ========================================== */
    #language-popup {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(0,0,0,0.8);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 70000;
    }
    
    #language-popup.show {
      display: flex;
    }
    
    .language-popup-content {
      background: linear-gradient(180deg, #3498DB 0%, #2980B9 100%);
      border-radius: 25px;
      padding: 25px 20px;
      max-width: 320px;
      width: 90%;
      box-shadow: 0 10px 40px rgba(0,0,0,0.4);
      border: 4px solid rgba(255,255,255,0.3);
    }
    
    .language-popup-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .language-popup-title {
      font-family: 'Nunito', sans-serif;
      font-weight: 900;
      font-size: 22px;
      color: #fff;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
      margin: 0;
    }
    
    .language-popup-close {
      width: 36px;
      height: 36px;
      background: #E74C3C;
      border: none;
      border-radius: 50%;
      font-size: 18px;
      color: #fff;
      cursor: pointer;
      display: flex;
      justify-content: center;
      align-items: center;
      box-shadow: 0 3px 10px rgba(231, 76, 60, 0.4);
    }
    
    .language-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    
    .language-btn {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px 20px;
      background: rgba(255,255,255,0.15);
      border: 2px solid rgba(255,255,255,0.3);
      border-radius: 15px;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .language-btn:hover,
    .language-btn.active {
      background: rgba(255,255,255,0.3);
      border-color: rgba(255,255,255,0.6);
    }
    
    .language-btn.active {
      border-color: #27AE60;
      box-shadow: 0 0 15px rgba(39, 174, 96, 0.4);
    }
    
    .language-flag {
      font-size: 32px;
    }
    
    .language-name {
      font-family: 'Nunito', sans-serif;
      font-weight: 700;
      font-size: 18px;
      color: #fff;
    }
    
    .language-check {
      margin-left: auto;
      font-size: 20px;
      color: #27AE60;
      display: none;
    }
    
    .language-btn.active .language-check {
      display: block;
    }
  </style>
  <script>
    // ==========================================
    // MULTI-LANGUAGE TRANSLATION SYSTEM
    // Supports: English, Arabic, Spanish, Italian, Russian
    // ==========================================
    const TRANSLATIONS = {
      en: {
        lang: 'English',
        flag: 'ðŸ‡¬ðŸ‡§',
        rtl: false,
        // Splash screen
        splashText: 'Preparing clues for you, please wait...',
        // Header
        level: 'Level',
        // Shop
        shop: 'SHOP',
        free: 'FREE',
        // Not enough coins popup
        notEnoughCoins: 'Not Enough Coins!',
        needMoreCoins: 'You need more coins to use this hint.',
        watchAd: 'Watch Ad',
        close: 'Close',
        // Win popup
        easy: 'Easy',
        medium: 'Medium',
        hard: 'Hard',
        solvedIn: 'Solved in less than {min} minutes!',
        nextLevel: 'Next Level â†’',
        playAgain: 'â†» Play again',
        // Lose popup
        tryAgain: 'Try Again!',
        dontWorry: "Don't worry, you can retry this level.",
        retry: 'Retry',
        // Game buttons (from original game)
        showHint: 'Show Hint',
        showMore: 'Show More',
        seeResults: 'See results',
        // Settings
        selectLanguage: 'Select Language',
        // Alerts
        earnedCoins: 'You earned {coins} coins!',
        adNotReady: 'Ad not ready yet. Please try again in a moment.',
        purchasedCoins: 'You purchased {coins} coins!',
        storeNotReady: 'Store not ready. Please try again.',
        purchaseFailed: 'Purchase failed. Please try again.',
        allLevelsComplete: 'All levels complete!',
        expert: 'Expert'
      },
      ar: {
        lang: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
        flag: 'ðŸ‡¸ðŸ‡¦',
        rtl: true,
        splashText: 'Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø£Ø¯Ù„Ø©ØŒ ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...',
        level: 'Ø§Ù„Ù…Ø³ØªÙˆÙ‰',
        shop: 'Ø§Ù„Ù…ØªØ¬Ø±',
        free: 'Ù…Ø¬Ø§Ù†ÙŠ',
        notEnoughCoins: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù…Ù„Ø§Øª ÙƒØ§ÙÙŠØ©!',
        needMoreCoins: 'ØªØ­ØªØ§Ø¬ Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„ØªÙ„Ù…ÙŠØ­.',
        watchAd: 'Ø´Ø§Ù‡Ø¯ Ø¥Ø¹Ù„Ø§Ù†',
        close: 'Ø¥ØºÙ„Ø§Ù‚',
        easy: 'Ø³Ù‡Ù„',
        medium: 'Ù…ØªÙˆØ³Ø·',
        hard: 'ØµØ¹Ø¨',
        solvedIn: 'ØªÙ… Ø§Ù„Ø­Ù„ ÙÙŠ Ø£Ù‚Ù„ Ù…Ù† {min} Ø¯Ù‚ÙŠÙ‚Ø©!',
        nextLevel: 'â† Ø§Ù„Ù…Ø³ØªÙˆÙ‰ Ø§Ù„ØªØ§Ù„ÙŠ',
        playAgain: 'â†» Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù„Ø¹Ø¨',
        tryAgain: 'Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!',
        dontWorry: 'Ù„Ø§ ØªÙ‚Ù„Ù‚ØŒ ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¹Ø§Ø¯Ø© Ù‡Ø°Ø§ Ø§Ù„Ù…Ø³ØªÙˆÙ‰.',
        retry: 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©',
        showHint: 'Ø¥Ø¸Ù‡Ø§Ø± ØªÙ„Ù…ÙŠØ­',
        showMore: 'Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø²ÙŠØ¯',
        seeResults: 'Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬',
        selectLanguage: 'Ø§Ø®ØªØ± Ø§Ù„Ù„ØºØ©',
        earnedCoins: 'Ù„Ù‚Ø¯ Ø±Ø¨Ø­Øª {coins} Ø¹Ù…Ù„Ø©!',
        adNotReady: 'Ø§Ù„Ø¥Ø¹Ù„Ø§Ù† ØºÙŠØ± Ø¬Ø§Ù‡Ø² Ø¨Ø¹Ø¯. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ Ù‚Ù„ÙŠÙ„.',
        purchasedCoins: 'Ù„Ù‚Ø¯ Ø§Ø´ØªØ±ÙŠØª {coins} Ø¹Ù…Ù„Ø©!',
        storeNotReady: 'Ø§Ù„Ù…ØªØ¬Ø± ØºÙŠØ± Ø¬Ø§Ù‡Ø². ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.',
        purchaseFailed: 'ÙØ´Ù„Øª Ø¹Ù…Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.',
        allLevelsComplete: 'ØªÙ… Ø¥ÙƒÙ…Ø§Ù„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª!',
        expert: 'Ø®Ø¨ÙŠØ±'
      },
      es: {
        lang: 'EspaÃ±ol',
        flag: 'ðŸ‡ªðŸ‡¸',
        rtl: false,
        splashText: 'Preparando pistas para ti, por favor espera...',
        level: 'Nivel',
        shop: 'TIENDA',
        free: 'GRATIS',
        notEnoughCoins: 'Â¡No hay suficientes monedas!',
        needMoreCoins: 'Necesitas mÃ¡s monedas para usar esta pista.',
        watchAd: 'Ver anuncio',
        close: 'Cerrar',
        easy: 'FÃ¡cil',
        medium: 'Medio',
        hard: 'DifÃ­cil',
        solvedIn: 'Â¡Resuelto en menos de {min} minutos!',
        nextLevel: 'Siguiente Nivel â†’',
        playAgain: 'â†» Jugar de nuevo',
        tryAgain: 'Â¡IntÃ©ntalo de nuevo!',
        dontWorry: 'No te preocupes, puedes reintentar este nivel.',
        retry: 'Reintentar',
        showHint: 'Mostrar pista',
        showMore: 'Mostrar mÃ¡s',
        seeResults: 'Ver resultados',
        selectLanguage: 'Seleccionar idioma',
        earnedCoins: 'Â¡Ganaste {coins} monedas!',
        adNotReady: 'El anuncio no estÃ¡ listo. Por favor, intÃ©ntalo en un momento.',
        purchasedCoins: 'Â¡Compraste {coins} monedas!',
        storeNotReady: 'La tienda no estÃ¡ lista. Por favor, intÃ©ntalo de nuevo.',
        purchaseFailed: 'La compra fallÃ³. Por favor, intÃ©ntalo de nuevo.',
        allLevelsComplete: 'Â¡Todos los niveles completados!',
        expert: 'Experto'
      },
      it: {
        lang: 'Italiano',
        flag: 'ðŸ‡®ðŸ‡¹',
        rtl: false,
        splashText: 'Preparando gli indizi per te, attendere prego...',
        level: 'Livello',
        shop: 'NEGOZIO',
        free: 'GRATIS',
        notEnoughCoins: 'Monete insufficienti!',
        needMoreCoins: 'Hai bisogno di piÃ¹ monete per usare questo suggerimento.',
        watchAd: 'Guarda annuncio',
        close: 'Chiudi',
        easy: 'Facile',
        medium: 'Medio',
        hard: 'Difficile',
        solvedIn: 'Risolto in meno di {min} minuti!',
        nextLevel: 'Livello Successivo â†’',
        playAgain: 'â†» Gioca ancora',
        tryAgain: 'Riprova!',
        dontWorry: 'Non preoccuparti, puoi riprovare questo livello.',
        retry: 'Riprova',
        showHint: 'Mostra suggerimento',
        showMore: 'Mostra altro',
        seeResults: 'Vedi risultati',
        selectLanguage: 'Seleziona lingua',
        earnedCoins: 'Hai guadagnato {coins} monete!',
        adNotReady: "L'annuncio non Ã¨ ancora pronto. Riprova tra un momento.",
        purchasedCoins: 'Hai acquistato {coins} monete!',
        storeNotReady: 'Il negozio non Ã¨ pronto. Riprova.',
        purchaseFailed: "L'acquisto non Ã¨ riuscito. Riprova.",
        allLevelsComplete: 'Tutti i livelli completati!',
        expert: 'Esperto'
      },
      ru: {
        lang: 'Ð ÑƒÑÑÐºÐ¸Ð¹',
        flag: 'ðŸ‡·ðŸ‡º',
        rtl: false,
        splashText: 'ÐŸÐ¾Ð´Ð³Ð¾Ñ‚Ð¾Ð²ÐºÐ° Ð¿Ð¾Ð´ÑÐºÐ°Ð·Ð¾Ðº, Ð¿Ð¾Ð¶Ð°Ð»ÑƒÐ¹ÑÑ‚Ð° Ð¿Ð¾Ð´Ð¾Ð¶Ð´Ð¸Ñ‚Ðµ...',
        level: 'Ð£Ñ€Ð¾Ð²ÐµÐ½ÑŒ',
        shop: 'ÐœÐÐ“ÐÐ—Ð˜Ð',
        free: 'Ð‘Ð•Ð¡ÐŸÐ›ÐÐ¢ÐÐž',
        notEnoughCoins: 'ÐÐµÐ´Ð¾ÑÑ‚Ð°Ñ‚Ð¾Ñ‡Ð½Ð¾ Ð¼Ð¾Ð½ÐµÑ‚!',
        needMoreCoins: 'Ð’Ð°Ð¼ Ð½ÑƒÐ¶Ð½Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐµ Ð¼Ð¾Ð½ÐµÑ‚, Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÑŒ ÑÑ‚Ñƒ Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÑƒ.',
        watchAd: 'Ð¡Ð¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ñ€ÐµÐºÐ»Ð°Ð¼Ñƒ',
        close: 'Ð—Ð°ÐºÑ€Ñ‹Ñ‚ÑŒ',
        easy: 'Ð›ÐµÐ³ÐºÐ¾',
        medium: 'Ð¡Ñ€ÐµÐ´Ð½Ðµ',
        hard: 'Ð¡Ð»Ð¾Ð¶Ð½Ð¾',
        solvedIn: 'Ð ÐµÑˆÐµÐ½Ð¾ Ð¼ÐµÐ½ÐµÐµ Ñ‡ÐµÐ¼ Ð·Ð° {min} Ð¼Ð¸Ð½ÑƒÑ‚!',
        nextLevel: 'Ð¡Ð»ÐµÐ´ÑƒÑŽÑ‰Ð¸Ð¹ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ â†’',
        playAgain: 'â†» Ð˜Ð³Ñ€Ð°Ñ‚ÑŒ ÑÐ½Ð¾Ð²Ð°',
        tryAgain: 'ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÑÐ½Ð¾Ð²Ð°!',
        dontWorry: 'ÐÐµ Ð²Ð¾Ð»Ð½ÑƒÐ¹Ñ‚ÐµÑÑŒ, Ð²Ñ‹ Ð¼Ð¾Ð¶ÐµÑ‚Ðµ Ð¿Ð¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ ÑÑ‚Ð¾Ñ‚ ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ.',
        retry: 'ÐŸÐ¾Ð²Ñ‚Ð¾Ñ€Ð¸Ñ‚ÑŒ',
        showHint: 'ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð¿Ð¾Ð´ÑÐºÐ°Ð·ÐºÑƒ',
        showMore: 'ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ ÐµÑ‰Ñ‘',
        seeResults: 'ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€ÐµÑ‚ÑŒ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹',
        selectLanguage: 'Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ ÑÐ·Ñ‹Ðº',
        earnedCoins: 'Ð’Ñ‹ Ð·Ð°Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ð»Ð¸ {coins} Ð¼Ð¾Ð½ÐµÑ‚!',
        adNotReady: 'Ð ÐµÐºÐ»Ð°Ð¼Ð° ÐµÑ‰Ñ‘ Ð½Ðµ Ð³Ð¾Ñ‚Ð¾Ð²Ð°. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ Ñ‡ÐµÑ€ÐµÐ· Ð¼Ð³Ð½Ð¾Ð²ÐµÐ½Ð¸Ðµ.',
        purchasedCoins: 'Ð’Ñ‹ ÐºÑƒÐ¿Ð¸Ð»Ð¸ {coins} Ð¼Ð¾Ð½ÐµÑ‚!',
        storeNotReady: 'ÐœÐ°Ð³Ð°Ð·Ð¸Ð½ Ð½Ðµ Ð³Ð¾Ñ‚Ð¾Ð². ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÐµÑ‰Ñ‘ Ñ€Ð°Ð·.',
        purchaseFailed: 'ÐŸÐ¾ÐºÑƒÐ¿ÐºÐ° Ð½Ðµ ÑƒÐ´Ð°Ð»Ð°ÑÑŒ. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÐµÑ‰Ñ‘ Ñ€Ð°Ð·.',
        allLevelsComplete: 'Ð’ÑÐµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð¿Ñ€Ð¾Ð¹Ð´ÐµÐ½Ñ‹!',
        expert: 'Ð­ÐºÑÐ¿ÐµÑ€Ñ‚'
      }
    };

    function getCurrentLanguage() {
      return localStorage.getItem('cluesbysam_language') || 'en';
    }

    function setLanguage(langCode) {
      localStorage.setItem('cluesbysam_language', langCode);
      applyTranslations();
      hideLanguagePopup();
    }

    function t(key, replacements = {}) {
      const lang = getCurrentLanguage();
      let text = TRANSLATIONS[lang][key] || TRANSLATIONS['en'][key] || key;
      for (const [k, v] of Object.entries(replacements)) {
        text = text.replace(`{${k}}`, v);
      }
      return text;
    }

    function applyTranslations() {
      const lang = getCurrentLanguage();
      const tr = TRANSLATIONS[lang];
      
      // Apply RTL for Arabic
      if (tr.rtl) {
        document.body.setAttribute('dir', 'rtl');
        document.documentElement.setAttribute('dir', 'rtl');
      } else {
        document.body.removeAttribute('dir');
        document.documentElement.removeAttribute('dir');
      }
      
      // Splash screen
      const splashText = document.querySelector('.splash-text');
      if (splashText) splashText.textContent = tr.splashText;
      
      // Level title
      const levelTitle = document.querySelector('.level-title');
      if (levelTitle) {
        const totalLevel = getTotalLevel();
        levelTitle.textContent = `${tr.level} ${totalLevel}`;
      }
      
      // Shop
      const shopTitle = document.querySelector('.shop-title');
      if (shopTitle) shopTitle.textContent = tr.shop;
      
      const freeBtn = document.querySelector('.shop-item-btn.free');
      if (freeBtn) freeBtn.innerHTML = `ðŸ“º ${tr.free}`;
      
      // Not enough coins popup
      const coinsPopupTitle = document.querySelector('.coins-popup-title');
      if (coinsPopupTitle) coinsPopupTitle.textContent = tr.notEnoughCoins;
      
      const coinsPopupMessage = document.querySelector('.coins-popup-message');
      if (coinsPopupMessage) coinsPopupMessage.textContent = tr.needMoreCoins;
      
      const watchAdBtn = document.querySelector('.coins-popup-btn.watch');
      if (watchAdBtn) watchAdBtn.innerHTML = `ðŸ“º ${tr.watchAd}`;
      
      const shopBtn = document.querySelector('.coins-popup-btn.shop');
      if (shopBtn) shopBtn.innerHTML = `ðŸ›’ ${tr.shop}`;
      
      const closeBtns = document.querySelectorAll('.coins-popup-btn.close, .win-button-close');
      closeBtns.forEach(btn => { if (btn) btn.textContent = tr.close; });
      
      // Win popup
      const nextLevelBtn = document.getElementById('next-level-btn');
      if (nextLevelBtn) nextLevelBtn.textContent = tr.nextLevel;
      
      const playAgainBtn = document.querySelector('.win-button-secondary');
      if (playAgainBtn) playAgainBtn.textContent = tr.playAgain;
      
      // Lose popup
      const loseTitle = document.querySelector('.lose-title');
      if (loseTitle) loseTitle.textContent = tr.tryAgain;
      
      const loseMessage = document.querySelector('#lose-popup .win-message');
      if (loseMessage) loseMessage.textContent = tr.dontWorry;
      
      const retryBtn = document.querySelector('.lose-button');
      if (retryBtn) retryBtn.textContent = tr.retry;
      
      // Language popup title
      const langTitle = document.querySelector('.language-popup-title');
      if (langTitle) langTitle.textContent = tr.selectLanguage;
      
      // Translate game buttons with interval (since they load dynamically)
      translateGameButtons();
    }

    function translateGameButtons() {
      const lang = getCurrentLanguage();
      const tr = TRANSLATIONS[lang];
      
      setInterval(() => {
        // Find and translate game buttons
        document.querySelectorAll('button, input[type="button"]').forEach(btn => {
          const text = btn.textContent.trim().toLowerCase();
          const value = btn.value ? btn.value.trim().toLowerCase() : '';
          
          // Show Hint button
          if (text.includes('show hint') || text.includes('hint') || 
              value.includes('show hint') || value.includes('hint')) {
            if (!btn.dataset.translated) {
              if (btn.value) btn.value = tr.showHint;
              else btn.textContent = tr.showHint;
              btn.dataset.translated = lang;
            }
          }
          
          // Show More button
          if (text.includes('show more') || text.includes('more') ||
              value.includes('show more') || value.includes('more')) {
            if (!btn.dataset.translated) {
              if (btn.value) btn.value = tr.showMore;
              else btn.textContent = tr.showMore;
              btn.dataset.translated = lang;
            }
          }
          
          // See results button
          if (text.includes('see results') || text.includes('results') ||
              value.includes('see results') || value.includes('results')) {
            if (!btn.dataset.translated) {
              if (btn.value) btn.value = tr.seeResults;
              else btn.textContent = tr.seeResults;
              btn.dataset.translated = lang;
            }
          }
          
          // Play again (in game's built-in popup)
          if (text.includes('play again')) {
            if (!btn.dataset.translated) {
              btn.textContent = tr.playAgain;
              btn.dataset.translated = lang;
            }
          }
          
          // Close button
          if (text === 'close') {
            if (!btn.dataset.translated) {
              btn.textContent = tr.close;
              btn.dataset.translated = lang;
            }
          }
        });
        
        // Translate difficulty text
        document.querySelectorAll('*').forEach(el => {
          if (el.childNodes.length === 1 && el.childNodes[0].nodeType === 3) {
            const text = el.textContent.trim();
            if (text === 'Easy' && !el.dataset.translated) {
              el.textContent = tr.easy;
              el.dataset.translated = lang;
            }
            if (text === 'Medium' && !el.dataset.translated) {
              el.textContent = tr.medium;
              el.dataset.translated = lang;
            }
            if (text === 'Hard' && !el.dataset.translated) {
              el.textContent = tr.hard;
              el.dataset.translated = lang;
            }
          }
        });
        
        // Translate "Solved in..." text
        document.querySelectorAll('*').forEach(el => {
          if (el.childNodes.length === 1 && el.childNodes[0].nodeType === 3) {
            const text = el.textContent.trim();
            const match = text.match(/Solved in less than (\d+) minutes!/);
            if (match && !el.dataset.translated) {
              el.textContent = tr.solvedIn.replace('{min}', match[1]);
              el.dataset.translated = lang;
            }
          }
        });
      }, 500);
    }

    function showLanguagePopup() {
      updateLanguageButtonStates();
      const popup = document.getElementById('language-popup');
      if (popup) popup.classList.add('show');
    }

    function hideLanguagePopup() {
      const popup = document.getElementById('language-popup');
      if (popup) popup.classList.remove('show');
    }
    
    function setupLanguageButtons() {
      const langBtns = document.querySelectorAll('.language-btn');
      langBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const lang = btn.dataset.lang;
          if (lang) {
            setLanguage(lang);
            location.reload();
          }
        });
      });
    }
    
    function updateLanguageButtonStates() {
      const currentLang = getCurrentLanguage();
      const langBtns = document.querySelectorAll('.language-btn');
      langBtns.forEach(btn => {
        if (btn.dataset.lang === currentLang) {
          btn.classList.add('active');
        } else {
          btn.classList.remove('active');
        }
      });
    }

    // ==========================================
    // LEVEL PROGRESSION SYSTEM
    // Total levels played tracking - continues past 50
    // ==========================================
    const TOTAL_PUZZLES = 50;

    // Get the total level number (1, 2, 3... 50, 51, 52...)
    function getTotalLevel() {
      return parseInt(localStorage.getItem('cluesbysam_total_level') || '1');
    }

    function setTotalLevel(level) {
      localStorage.setItem('cluesbysam_total_level', level.toString());
    }

    // Get which puzzle to load (1-50, cycling)
    function getPuzzleNumber(totalLevel) {
      return ((totalLevel - 1) % TOTAL_PUZZLES) + 1;
    }

    // Obfuscated puzzle hash map - only you know these!
    const PUZZLE_HASHES = {
      1: "8aa15091a232", 2: "bad1fcbd0ec5", 3: "684233c01fca", 4: "23c43dbe2a37", 5: "9c53c1ae5344",
      6: "78e820375276", 7: "de6c2fb44bd1", 8: "b6b573e8de8e", 9: "da0bb9fb2cd9", 10: "6baae50faf8a",
      11: "6cbf6d256778", 12: "b7b982ec1191", 13: "656f4ab5e464", 14: "f3042cb0f5ec", 15: "6c1a70232b95",
      16: "d6235521a569", 17: "21493e6b6140", 18: "703916bb416d", 19: "5a5aa0bd997c", 20: "98c74c6d6e44",
      21: "51f3ecf10a81", 22: "e8dde6ff8dc1", 23: "6efda75291c8", 24: "63b339a39097", 25: "175ca6478890",
      26: "262ff76dcd13", 27: "ed23e2304ae8", 28: "bb3664b02089", 29: "2f42fbfcdaf9", 30: "c629d699bf3c",
      31: "521c0eb12288", 32: "83f5e2a2c9d3", 33: "92471ae08a9c", 34: "11cb6872e594", 35: "48ce3cb8cfbd",
      36: "c72891018b1b", 37: "4d49ca3e2134", 38: "5ea3be3177d5", 39: "b3eef6f8d2bb", 40: "6e2c04ee211d",
      41: "6310edfd1b2b", 42: "d9e838da8fb9", 43: "ab644e25dde8", 44: "d645485f7161", 45: "5e9419f2e0fa",
      46: "5096b4d921c5", 47: "dae6db907d2b", 48: "43537ae10d78", 49: "5220a658f51b", 50: "165362d90111"
    };

    function loadLevel(totalLevel) {
      const puzzleNum = getPuzzleNumber(totalLevel);
      const hash = PUZZLE_HASHES[puzzleNum];
      const scriptPath = `./game/assets/${hash}.js`;
      console.log(`Loading Level ${totalLevel}: ${scriptPath}`);

      const script = document.createElement('script');
      script.type = 'module';
      script.crossOrigin = 'anonymous';
      script.src = scriptPath;
      document.head.appendChild(script);
    }

    // ==========================================
    // SPLASH SCREEN
    // ==========================================
    function hideSplash() {
      const splash = document.getElementById('splash-screen');
      if (splash) {
        splash.classList.add('hidden');
        setTimeout(() => {
          splash.style.display = 'none';
        }, 500);
      }
    }

    function animateSplashProgress() {
      const progressBar = document.querySelector('.splash-progress-bar');
      if (progressBar) {
        let progress = 0;
        const interval = setInterval(() => {
          progress += Math.random() * 35 + 25;
          if (progress >= 100) {
            progress = 100;
            clearInterval(interval);
            setTimeout(hideSplash, 100);
          }
          progressBar.style.width = progress + '%';
        }, 80);
      }
    }

    // ==========================================
    // PROGRESS TRACKING - REFERENCE STYLE
    // ==========================================
    let totalCards = 0;
    let clearedCards = 0;
    let criminalCount = 0;

    function updateProgress() {
      const progressFill = document.getElementById('progress-fill');
      const progressText = document.getElementById('progress-text');
      
      if (progressText) {
        progressText.textContent = `${clearedCards}/${totalCards}`;
      }
      
      if (progressFill && totalCards > 0) {
        const percent = (clearedCards / totalCards) * 100;
        progressFill.style.width = percent + '%';
      }
    }

    function countCards() {
      const cards = document.querySelectorAll('.card');
      totalCards = cards.length;
      clearedCards = document.querySelectorAll('.card.innocent, .card.criminal').length;
      criminalCount = document.querySelectorAll('.card.criminal').length;
      updateProgress();
    }

    // ==========================================
    // COINS SYSTEM
    // ==========================================
    const HINT_COST = 10;
    const MORE_HINT_COST = 15;
    const REWARDED_AD_COINS = 25;
    
    function getCoins() {
      return parseInt(localStorage.getItem('cluesbysam_coins') || '50');
    }
    
    function setCoins(amount) {
      localStorage.setItem('cluesbysam_coins', amount.toString());
      updateCoinsDisplay();
    }
    
    function addCoins(amount) {
      const current = getCoins();
      setCoins(current + amount);
    }
    
    function spendCoins(amount) {
      const current = getCoins();
      if (current >= amount) {
        setCoins(current - amount);
        return true;
      }
      return false;
    }
    
    function updateCoinsDisplay() {
      const coins = getCoins();
      const displays = document.querySelectorAll('#coins-amount, #shop-coins-amount');
      displays.forEach(d => {
        if (d) d.textContent = coins.toLocaleString();
      });
    }
    
    // ==========================================
    // SHOP FUNCTIONS
    // ==========================================
    function showShop() {
      updateCoinsDisplay();
      const popup = document.getElementById('shop-popup');
      if (popup) popup.classList.add('show');
    }
    
    function hideShop() {
      const popup = document.getElementById('shop-popup');
      if (popup) popup.classList.remove('show');
    }
    
    function showCoinsPopup() {
      const popup = document.getElementById('coins-popup');
      if (popup) popup.classList.add('show');
    }
    
    function hideCoinsPopup() {
      const popup = document.getElementById('coins-popup');
      if (popup) popup.classList.remove('show');
    }
    
    // ==========================================
    // ADMOB INTEGRATION
    // ==========================================
    let admobInitialized = false;
    let interstitialReady = false;
    let rewardedReady = false;
    
    // AdMob Ad Unit IDs (Replace with your actual IDs for production)
    const AD_IDS = {
      banner: 'ca-app-pub-3940256099942544/6300978111',
      interstitial: 'ca-app-pub-3940256099942544/1033173712',
      rewarded: 'ca-app-pub-3940256099942544/5224354917',
      appOpen: 'ca-app-pub-3940256099942544/9257395921'
    };
    
    async function initializeAdMob() {
      if (typeof window.Capacitor === 'undefined' || !window.Capacitor.isNativePlatform()) {
        console.log('AdMob: Not running on native platform');
        return;
      }
      
      try {
        const { AdMob } = await import('@capacitor-community/admob');
        if (!AdMob) {
          console.log('AdMob plugin not available');
          return;
        }
        
        await AdMob.initialize({
          initializeForTesting: true
        });
        admobInitialized = true;
        console.log('AdMob initialized');
        
        setTimeout(() => showBannerAd(), 500);
        setTimeout(() => prepareInterstitial(), 1000);
        setTimeout(() => prepareRewarded(), 1500);
        setTimeout(() => showAppOpenAd(), 2000);
      } catch (e) {
        console.log('AdMob init error:', e);
      }
    }
    
    async function showBannerAd() {
      if (!admobInitialized) return;
      
      try {
        const { AdMob, BannerAdSize, BannerAdPosition } = await import('@capacitor-community/admob');
        await AdMob.showBanner({
          adId: AD_IDS.banner,
          adSize: BannerAdSize.BANNER,
          position: BannerAdPosition.BOTTOM_CENTER,
          margin: 0,
          isTesting: true
        });
      } catch (e) {
        console.log('Banner ad error:', e);
      }
    }
    
    async function prepareInterstitial() {
      if (!admobInitialized) return;
      
      try {
        const { AdMob, InterstitialAdPluginEvents } = await import('@capacitor-community/admob');
        
        AdMob.addListener(InterstitialAdPluginEvents.Loaded, () => {
          interstitialReady = true;
          console.log('Interstitial ready');
        });
        
        AdMob.addListener(InterstitialAdPluginEvents.Dismissed, () => {
          interstitialReady = false;
          prepareInterstitial();
        });
        
        await AdMob.prepareInterstitial({
          adId: AD_IDS.interstitial,
          isTesting: true
        });
      } catch (e) {
        console.log('Interstitial prep error:', e);
      }
    }
    
    async function showInterstitialAd() {
      if (!admobInitialized || !interstitialReady) return;
      
      try {
        const { AdMob } = await import('@capacitor-community/admob');
        await AdMob.showInterstitial();
      } catch (e) {
        console.log('Interstitial show error:', e);
      }
    }
    
    async function prepareRewarded() {
      if (!admobInitialized) return;
      
      try {
        const { AdMob, RewardAdPluginEvents } = await import('@capacitor-community/admob');
        
        AdMob.addListener(RewardAdPluginEvents.Loaded, () => {
          rewardedReady = true;
          console.log('Rewarded ad ready');
        });
        
        AdMob.addListener(RewardAdPluginEvents.Rewarded, (reward) => {
          console.log('User earned reward:', reward);
          addCoins(REWARDED_AD_COINS);
          alert(t('earnedCoins', {coins: REWARDED_AD_COINS}));
        });
        
        AdMob.addListener(RewardAdPluginEvents.Dismissed, () => {
          rewardedReady = false;
          prepareRewarded();
        });
        
        await AdMob.prepareRewardVideoAd({
          adId: AD_IDS.rewarded,
          isTesting: true
        });
      } catch (e) {
        console.log('Rewarded prep error:', e);
      }
    }
    
    async function watchRewardedAd() {
      if (typeof window.Capacitor === 'undefined') {
        addCoins(REWARDED_AD_COINS);
        alert(t('earnedCoins', {coins: REWARDED_AD_COINS}));
        hideShop();
        return;
      }
      
      if (!rewardedReady) {
        alert(t('adNotReady'));
        return;
      }
      
      try {
        const { AdMob } = await import('@capacitor-community/admob');
        await AdMob.showRewardVideoAd();
        hideShop();
      } catch (e) {
        console.log('Rewarded show error:', e);
      }
    }
    
    async function showAppOpenAd() {
      if (!admobInitialized) return;
      
      try {
        const { AdMob } = await import('@capacitor-community/admob');
        await AdMob.prepareAppOpenAd({
          adId: AD_IDS.appOpen,
          isTesting: true
        });
        await AdMob.showAppOpenAd();
      } catch (e) {
        console.log('App open ad error:', e);
      }
    }
    
    // ==========================================
    // REVENUECAT IN-APP PURCHASES
    // ==========================================
    let revenueCatInitialized = false;
    
    const COIN_PRODUCTS = {
      'coins_150': 150,
      'coins_450': 450,
      'coins_1500': 1500,
      'coins_4000': 4000,
      'coins_7500': 7500,
      'coins_15000': 15000
    };
    
    async function initializeRevenueCat() {
      if (typeof window.Capacitor === 'undefined' || !window.Capacitor.isNativePlatform()) {
        console.log('RevenueCat: Not running on native platform');
        return;
      }
      
      const REVENUECAT_API_KEY = 'YOUR_REVENUECAT_API_KEY';
      if (REVENUECAT_API_KEY === 'YOUR_REVENUECAT_API_KEY') {
        console.log('RevenueCat: API key not configured');
        return;
      }
      
      try {
        const { Purchases, LOG_LEVEL } = await import('@revenuecat/purchases-capacitor');
        
        await Purchases.setLogLevel({ level: LOG_LEVEL.DEBUG });
        await Purchases.configure({
          apiKey: REVENUECAT_API_KEY
        });
        
        revenueCatInitialized = true;
        console.log('RevenueCat initialized');
      } catch (e) {
        console.log('RevenueCat init error:', e);
      }
    }
    
    async function purchaseCoins(productId) {
      if (typeof window.Capacitor === 'undefined') {
        const coins = COIN_PRODUCTS[productId] || 0;
        addCoins(coins);
        alert(t('purchasedCoins', {coins: coins}));
        updateCoinsDisplay();
        return;
      }
      
      if (!revenueCatInitialized) {
        alert(t('storeNotReady'));
        return;
      }
      
      try {
        const { Purchases } = await import('@revenuecat/purchases-capacitor');
        
        const offerings = await Purchases.getOfferings();
        console.log('Offerings:', offerings);
        
        const result = await Purchases.purchaseStoreProduct({
          product: { identifier: productId }
        });
        
        if (result.customerInfo) {
          const coins = COIN_PRODUCTS[productId] || 0;
          addCoins(coins);
          alert(t('purchasedCoins', {coins: coins}));
          updateCoinsDisplay();
        }
      } catch (e) {
        if (e.code !== 'PURCHASE_CANCELLED') {
          console.log('Purchase error:', e);
          alert(t('purchaseFailed'));
        }
      }
    }
    
    
    // ==========================================
    // HINT SYSTEM WITH COINS (WITH CLICK LOCK)
    // ==========================================
    const SHOW_HINT_COST = 10;
    const SHOW_MORE_COST = 15;
    let hintClickLock = false;
    let lastHintClickTime = 0;
    
    function setupHintCostSystem() {
      const allButtons = document.querySelectorAll('button, input[type="button"], .btn');
      
      allButtons.forEach(btn => {
        if (btn.dataset.hintHandled === 'true') return;
        
        const originalText = (btn.textContent || btn.value || '').toLowerCase();
        
        const isHintBtn = originalText.includes('hint') && !originalText.includes('ðŸª™');
        const isShowBtn = originalText.includes('show') && !originalText.includes('ðŸª™') && !originalText.includes('shop');
        
        if (isHintBtn || isShowBtn) {
          btn.dataset.hintHandled = 'true';
          
          let cost = SHOW_HINT_COST;
          if (originalText.includes('more')) {
            cost = SHOW_MORE_COST;
          }
          btn.dataset.hintCost = cost;
          
          const costBadge = document.createElement('span');
          costBadge.className = 'hint-cost-badge';
          costBadge.style.cssText = 'margin-left: 5px; font-size: 11px; opacity: 0.9;';
          costBadge.textContent = `(${cost}ðŸª™)`;
          btn.appendChild(costBadge);
          
          function handleHintClick(e) {
            const now = Date.now();
            
            if (hintClickLock || (now - lastHintClickTime) < 1000) {
              e.preventDefault();
              e.stopPropagation();
              e.stopImmediatePropagation();
              return false;
            }
            
            const btnCost = parseInt(btn.dataset.hintCost) || SHOW_HINT_COST;
            const currentCoins = getCoins();
            
            if (currentCoins < btnCost) {
              e.preventDefault();
              e.stopPropagation();
              e.stopImmediatePropagation();
              showCoinsPopup();
              console.log('Not enough coins for hint');
              return false;
            }
            
            hintClickLock = true;
            lastHintClickTime = now;
            spendCoins(btnCost);
            console.log(`Spent ${btnCost} coins on hint. Remaining: ${getCoins()}`);
            
            setTimeout(() => { hintClickLock = false; }, 1000);
            
            // Allow the original hint action to proceed (do NOT block the event)
          }
          
          btn.addEventListener('click', handleHintClick, false);
        }
      });
    }
    
    function interceptHintButton() {
      setupHintCostSystem();
      setInterval(setupHintCostSystem, 3000);
    }



    // ==========================================
    // WIN/LOSE POPUPS
    // ==========================================
    const TOTAL_LEVELS = 50;
    let levelStartTime = Date.now();
    
    function showWinPopup() {
      const popup = document.getElementById('win-popup');
      if (!popup) return;
      
      const tr = TRANSLATIONS[getCurrentLanguage()];
      const currentLevel = getTotalLevel();
      const elapsedMs = Date.now() - levelStartTime;
      const elapsedMins = Math.ceil(elapsedMs / 60000);
      
      const levelTitle = document.getElementById('win-level-title');
      if (levelTitle) levelTitle.textContent = `${tr.level} ${currentLevel}`;
      
      const difficulty = document.getElementById('win-difficulty');
      if (difficulty) {
        if (currentLevel <= 10) difficulty.textContent = tr.easy;
        else if (currentLevel <= 25) difficulty.textContent = tr.medium;
        else if (currentLevel <= 40) difficulty.textContent = tr.hard;
        else difficulty.textContent = tr.expert;
      }
      
      const timeMsg = document.getElementById('win-time-message');
      if (timeMsg) {
        timeMsg.textContent = tr.solvedIn.replace('{min}', elapsedMins);
      }
      
      generateWinGrid();
      
      const nextBtn = document.getElementById('next-level-btn');
      if (nextBtn) {
        if (currentLevel >= TOTAL_LEVELS) {
          nextBtn.textContent = tr.allLevelsComplete;
          nextBtn.disabled = true;
          nextBtn.style.opacity = '0.5';
        } else {
          nextBtn.textContent = tr.nextLevel;
          nextBtn.disabled = false;
          nextBtn.style.opacity = '1';
        }
      }
      
      popup.classList.add('show');
    }
    
    function generateWinGrid() {
      const grid = document.getElementById('win-grid');
      if (!grid) return;
      grid.innerHTML = '';
      
      const colors = ['green', 'yellow', 'orange'];
      for (let row = 0; row < 4; row++) {
        const rowDiv = document.createElement('div');
        rowDiv.className = 'win-grid-row';
        for (let col = 0; col < 4; col++) {
          const cell = document.createElement('div');
          cell.className = 'win-grid-cell ' + colors[Math.floor(Math.random() * 3)];
          rowDiv.appendChild(cell);
        }
        grid.appendChild(rowDiv);
      }
    }

    function goToNextLevelFromPopup() {
      const popup = document.getElementById('win-popup');
      if (popup) popup.classList.remove('show');
      
      const currentLevel = getTotalLevel();
      if (currentLevel < TOTAL_LEVELS) {
        showInterstitialAd();
        setTotalLevel(currentLevel + 1);
        levelStartTime = Date.now();
        location.reload();
      }
    }
    
    function playAgain() {
      const popup = document.getElementById('win-popup');
      if (popup) popup.classList.remove('show');
      levelStartTime = Date.now();
      location.reload();
    }
    
    function closeWinPopup() {
      const popup = document.getElementById('win-popup');
      if (popup) popup.classList.remove('show');
    }

    function hideWinPopup() {
      const popup = document.getElementById('win-popup');
      if (popup) popup.classList.remove('show');
    }

    function showLosePopup() {
      const popup = document.getElementById('lose-popup');
      if (popup) popup.classList.add('show');
    }

    function hideLosePopup() {
      const popup = document.getElementById('lose-popup');
      if (popup) popup.classList.remove('show');
    }

    // ==========================================
    // THEME SYSTEM
    // ==========================================
    function callShare() {
      window.share(true);
    }

    const THEMES = ["theme-default", "theme-acc-1"];

    function convert(savedTheme) {
      if (savedTheme == "theme-default") return { theme: 0, dark: true };
      if (savedTheme == "theme-acc-1") return { theme: 1, dark: true };
      else return { theme: 0, dark: true };
    }

    document.addEventListener("DOMContentLoaded", () => {
      console.log("Load");
      
      // Apply translations first
      applyTranslations();
      
      // Start splash animation
      animateSplashProgress();
      
      // Initialize coins display
      updateCoinsDisplay();
      
      // Initialize monetization systems
      initializeAdMob();
      initializeRevenueCat();
      
      // Start hint button interception
      interceptHintButton();
      
      const themePreference = convert(localStorage.getItem("theme"));
      document.body.className = `${THEMES[themePreference.theme]} ${themePreference.dark ? "light" : "light"}`;

      // Update level display with translation
      const totalLevel = getTotalLevel();
      const tr = TRANSLATIONS[getCurrentLanguage()];
      const levelTitle = document.querySelector('.level-title');
      if (levelTitle) {
        levelTitle.textContent = `${tr.level} ${totalLevel}`;
      }

      // Monitor for card changes to update progress
      setInterval(() => {
        countCards();
      }, 500);

      // Replace "Puzzle #X" text in the game with actual level number
      replacePuzzleText(totalLevel);
      
      // Watch for game's built-in popup and inject Next Level button
      injectNextLevelButton();
      
      // Setup language selector buttons
      setupLanguageButtons();
    });

    // Replace "Puzzle #X" text in the game
    function replacePuzzleText(totalLevel) {
      setInterval(() => {
        const tr = TRANSLATIONS[getCurrentLanguage()];
        // Find all text nodes and elements containing "Puzzle #"
        const walker = document.createTreeWalker(
          document.body,
          NodeFilter.SHOW_TEXT,
          null,
          false
        );

        let node;
        while (node = walker.nextNode()) {
          if (node.nodeValue && node.nodeValue.match(/Puzzle #\d+/)) {
            node.nodeValue = node.nodeValue.replace(/Puzzle #\d+/, `${tr.level} ${totalLevel}`);
          }
        }
      }, 500);
    }

    // ==========================================
    // INJECT NEXT LEVEL BUTTON INTO GAME'S POPUP
    // ==========================================
    function injectNextLevelButton() {
      const observer = new MutationObserver((mutations) => {
        mutations.forEach((mutation) => {
          mutation.addedNodes.forEach((node) => {
            if (node.nodeType === 1) {
              checkAndInjectButton(node);
            }
          });
        });
      });
      
      observer.observe(document.body, { childList: true, subtree: true });
      
      setInterval(() => {
        const popups = document.querySelectorAll('[class*="modal"], [class*="popup"], [class*="dialog"], [role="dialog"]');
        popups.forEach(popup => checkAndInjectButton(popup));
        
        const buttons = document.querySelectorAll('button');
        buttons.forEach(btn => {
          const text = btn.textContent.toLowerCase();
          if ((text.includes('play again') || text.includes('close')) && !btn.parentElement.querySelector('.next-level-injected')) {
            injectButtonNear(btn);
          }
        });
      }, 1000);
    }
    
    function checkAndInjectButton(element) {
      const text = element.textContent || '';
      if (text.includes('Solved in') || text.includes('Play again')) {
        const buttons = element.querySelectorAll('button');
        buttons.forEach(btn => {
          if ((btn.textContent.includes('Play again') || btn.textContent.includes('Close')) && 
              !btn.parentElement.querySelector('.next-level-injected')) {
            injectButtonNear(btn);
          }
        });
      }
    }
    
    function injectButtonNear(existingButton) {
      if (existingButton.parentElement.querySelector('.next-level-injected')) return;
      
      const nextBtn = document.createElement('button');
      nextBtn.className = 'next-level-injected';
      nextBtn.textContent = 'Next Level â†’';
      nextBtn.style.cssText = `
        display: block;
        width: 100%;
        background: linear-gradient(180deg, #27AE60 0%, #1E8449 100%);
        color: #fff;
        font-family: 'Nunito', sans-serif;
        font-weight: 800;
        font-size: 16px;
        padding: 14px 20px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        margin-bottom: 10px;
        box-shadow: 0 4px 12px rgba(39, 174, 96, 0.4);
      `;
      
      nextBtn.onclick = function(e) {
        e.preventDefault();
        e.stopPropagation();
        const current = getTotalLevel();
        if (current < 50) {
          showInterstitialAd();
          setTotalLevel(current + 1);
          location.reload();
        }
      };
      
      const parent = existingButton.parentElement;
      parent.insertBefore(nextBtn, parent.firstChild);
    }

    // ==========================================
    // LEVEL NAVIGATION
    // ==========================================
    function goToNextLevel() {
      const current = getTotalLevel();
      setTotalLevel(current + 1);
      location.reload();
    }

    function goToPrevLevel() {
      const current = getTotalLevel();
      if (current > 1) {
        setTotalLevel(current - 1);
        location.reload();
      }
    }

    // Load the current level's script
    loadLevel(getTotalLevel());
  </script>
  <link rel="stylesheet" crossorigin href="./assets/index.css">
</head>

<body class="theme-default">
  <!-- SPLASH SCREEN -->
  <div id="splash-screen">
    <div class="splash-icon">ðŸ”</div>
    <div class="splash-logo">Clues<br>by Sam</div>
    <div class="splash-text">Preparing clues for you, please wait...</div>
    <div class="splash-progress">
      <div class="splash-progress-bar"></div>
    </div>
  </div>

  <div id="fontPreload" style="position: absolute; top: -9999px; font-family: 'Ribeye'">Loading...</div>
  <div id="fontPreload" style="position: absolute; top: -9999px; font-family: 'Comic Neue'">Loading...</div>
  <div id="fontPreload" style="position: absolute; top: -9999px; font-family: 'Nunito'">Loading...</div>

  <!-- NEW HEADER -->
  <div class="game-header">
    <!-- TOP ROW: Settings, Level, Coins -->
    <div class="header-top">
      <button class="settings-btn" onclick="showLanguagePopup()">âš™ï¸</button>
      <h1 class="level-title">Level 1</h1>
      <div class="coins-display" onclick="showShop()">
        <span class="coins-icon">ðŸª™</span>
        <span class="coins-amount" id="coins-amount">0</span>
        <span class="coins-plus">+</span>
      </div>
    </div>
    <!-- BOTTOM ROW: Progress Bar Only -->
    <div class="header-bottom">
      <div class="progress-container">
        <div class="progress-fill" id="progress-fill"></div>
        <span class="progress-text" id="progress-text">0/0</span>
      </div>
    </div>
  </div>

  <!-- OLD LEVEL DISPLAY (HIDDEN) -->
  <div id="level-display"><b>Level 1</b></div>

  <!-- GAME CONTAINER -->
  <div id="root"></div>


  <!-- WIN POPUP -->
  <div id="win-popup">
    <div class="win-content">
      <h2 class="win-level-title" id="win-level-title">Level 1</h2>
      <p class="win-difficulty" id="win-difficulty">Easy</p>
      <div class="win-grid" id="win-grid"></div>
      <p class="win-message" id="win-time-message">Solved in less than 70 minutes!</p>
      <div class="win-buttons">
        <button class="win-button-next" id="next-level-btn" onclick="goToNextLevelFromPopup()">Next Level â†’</button>
        <button class="win-button-secondary" onclick="playAgain()">â†» Play again</button>
        <button class="win-button-close" onclick="closeWinPopup()">Close</button>
      </div>
    </div>
  </div>

  <!-- LOSE POPUP -->
  <div id="lose-popup">
    <div class="lose-content">
      <div class="win-icon">ðŸ˜¢</div>
      <h2 class="lose-title">Try Again!</h2>
      <p class="win-message">Don't worry, you can retry this level.</p>
      <button class="lose-button" onclick="hideLosePopup()">Retry</button>
    </div>
  </div>

  <!-- SHOP POPUP -->
  <div id="shop-popup">
    <div class="shop-content">
      <button class="shop-close" onclick="hideShop()">âœ•</button>
      <div class="shop-header">
        <div class="shop-coins-display">
          <span class="coins-icon">ðŸª™</span>
          <span class="coins-amount" id="shop-coins-amount">0</span>
        </div>
        <h2 class="shop-title">SHOP</h2>
      </div>
      <div class="shop-items">
        <div class="shop-item">
          <div class="shop-item-left">
            <span class="shop-item-icon">ðŸª™</span>
            <span class="shop-item-amount">25</span>
          </div>
          <button class="shop-item-btn free" onclick="watchRewardedAd()">ðŸ“º FREE</button>
        </div>
        <div class="shop-item">
          <div class="shop-item-left">
            <span class="shop-item-icon">ðŸª™</span>
            <span class="shop-item-amount">150</span>
          </div>
          <button class="shop-item-btn buy" onclick="purchaseCoins('coins_150')">AED 7.99</button>
        </div>
        <div class="shop-item">
          <div class="shop-item-left">
            <span class="shop-item-icon">ðŸ’°</span>
            <span class="shop-item-amount">450</span>
          </div>
          <button class="shop-item-btn buy" onclick="purchaseCoins('coins_450')">AED 29.99</button>
        </div>
        <div class="shop-item">
          <div class="shop-item-left">
            <span class="shop-item-icon">ðŸ’°</span>
            <span class="shop-item-amount">1,500</span>
          </div>
          <button class="shop-item-btn buy" onclick="purchaseCoins('coins_1500')">AED 59.99</button>
        </div>
        <div class="shop-item">
          <div class="shop-item-left">
            <span class="shop-item-icon">ðŸ’°</span>
            <span class="shop-item-amount">4,000</span>
          </div>
          <button class="shop-item-btn buy" onclick="purchaseCoins('coins_4000')">AED 99.99</button>
        </div>
        <div class="shop-item">
          <div class="shop-item-left">
            <span class="shop-item-icon">ðŸ’Ž</span>
            <span class="shop-item-amount">7,500</span>
          </div>
          <button class="shop-item-btn buy" onclick="purchaseCoins('coins_7500')">AED 199.99</button>
        </div>
        <div class="shop-item">
          <div class="shop-item-left">
            <span class="shop-item-icon">ðŸ’Ž</span>
            <span class="shop-item-amount">15,000</span>
          </div>
          <button class="shop-item-btn buy" onclick="purchaseCoins('coins_15000')">AED 399.99</button>
        </div>
      </div>
    </div>
  </div>

  <!-- NOT ENOUGH COINS POPUP -->
  <div id="coins-popup">
    <div class="coins-popup-content">
      <div class="coins-popup-icon">ðŸ˜¢</div>
      <div class="coins-popup-title">Not Enough Coins!</div>
      <div class="coins-popup-message">You need more coins to use this hint.</div>
      <div class="coins-popup-buttons">
        <button class="coins-popup-btn watch" onclick="hideCoinsPopup(); watchRewardedAd();">ðŸ“º Watch Ad</button>
        <button class="coins-popup-btn shop" onclick="hideCoinsPopup(); showShop();">ðŸ›’ Shop</button>
        <button class="coins-popup-btn close" onclick="hideCoinsPopup()">Close</button>
      </div>
    </div>
  </div>

  <!-- LANGUAGE SELECTOR POPUP -->
  <div id="language-popup">
    <div class="language-popup-content">
      <div class="language-popup-header">
        <h2 class="language-popup-title">Select Language</h2>
        <button class="language-popup-close" onclick="hideLanguagePopup()">âœ•</button>
      </div>
      <div class="language-list">
        <button class="language-btn active" data-lang="en">
          <span class="language-flag">ðŸ‡¬ðŸ‡§</span>
          <span class="language-name">English</span>
          <span class="language-check">âœ“</span>
        </button>
        <button class="language-btn" data-lang="ar">
          <span class="language-flag">ðŸ‡¸ðŸ‡¦</span>
          <span class="language-name">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</span>
          <span class="language-check">âœ“</span>
        </button>
        <button class="language-btn" data-lang="es">
          <span class="language-flag">ðŸ‡ªðŸ‡¸</span>
          <span class="language-name">EspaÃ±ol</span>
          <span class="language-check">âœ“</span>
        </button>
        <button class="language-btn" data-lang="it">
          <span class="language-flag">ðŸ‡®ðŸ‡¹</span>
          <span class="language-name">Italiano</span>
          <span class="language-check">âœ“</span>
        </button>
        <button class="language-btn" data-lang="ru">
          <span class="language-flag">ðŸ‡·ðŸ‡º</span>
          <span class="language-name">Ð ÑƒÑÑÐºÐ¸Ð¹</span>
          <span class="language-check">âœ“</span>
        </button>
      </div>
    </div>
  </div>

  <!-- BANNER AD SPACE -->
  <div class="banner-ad-space" id="banner-ad-space"></div>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      if (window.Capacitor && window.Capacitor.Plugins && window.Capacitor.Plugins.App) {
        var App = window.Capacitor.Plugins.App;
        App.addListener('backButton', function(data) {
          if (data.canGoBack) {
            window.history.back();
          } else {
            App.exitApp();
          }
        });
      }
    });
  </script>
</body>

</html>